---
description: 実験の追跡、データセットのバージョン管理、モデル管理のためのWeights＆Biases
---

# Library

 `wandb` Pythonライブラリを使用して、数行のコードで機械学習実験を追跡します。[PyTorch](../integrations/pytorch.md)や[Keras](../integrations/keras.md)などの一般的なフレームワークを使用している場合は、軽量な[統合](https://app.gitbook.com/@weights-and-biases/s/docs/~/drafts/-MNTRmPsdM-fSSOyCL8w/v/japanese/integrations)を実現しています。

## **概要**

W＆Bで実験を追跡するには：

1. \*\*\*\*[**wandb.init\(\)**](init.md):  スクリプトの先頭で新しい実行を初期化します。これにより、Runオブジェクトが返され、すべてのログとファイルが保存されるローカルディレクトリが作成され、W＆Bサーバーに非同期でストリーミングされます。ホスト型クラウドサーバーの代わりにプライベートサーバーを使用したい場合は、[セルフホスティングを提供しています](https://app.gitbook.com/@weights-and-biases/s/docs/~/drafts/-MNTRmPsdM-fSSOyCL8w/v/japanese/self-hosted)。
2. \*\*\*\*[**wandb.config**](config.md): 学習率やモデルタイプなどのハイパーパラメータの辞書を保存します。configでキャプチャしたモデル設定により、後で結果を整理して質問することができます。
3. \*\*\*\*[**wandb.log\(\)**](log.md): 精度や損失など、トレーニングループ内の時間の経過に伴うメトリックをログに記録します。デフォルトでは、wandb.log（）を呼び出すと、履歴オブジェクトに新しいステップが追加され、サマリーオブジェクトが更新されます。

   o   **ヒストリー**：時間の経過とともにメトリックを追跡する辞書のようなオブジェクトの配列。これらの時系列値は、UIにデフォルトのラインプロットとして表示されます。

   o   **サマリー**：デフォルトで、wandb.log（）でログに記録されるメトリックの最終値。メトリックの要約を手動で設定して、最終値の代わりに最高の精度または最低の損失を取得できます。これらの値は、実行を比較するテーブルとプロットで使用されます。たとえば、プロジェクト内のすべての実行の最終的な精度で視覚化できます。

4. \*\*\*\*[**Artifacts**](../artifacts/): モデルの重みや予測の表など、実行の出力をアーティファクトに保存します。**run.use\_artifact**と組み合わせると、トレーニングステップだけでなく、最終モデルに影響を与えるすべてのパイプライン部分を追跡できます

##  **ベストプラクティス**

`wandb`ライブラリは非常に柔軟です。いくつかの推奨ガイドラインを以下に提示します。

1.  **構成・設定**：ハイパーパラメータ、アーキテクチャ、データセット、およびモデルの再現に使用しようとする他のものを追跡します。これらは列に表示されます。構成列を使用して、アプリで実行を動的にグループ化、並べ替え、フィルタリングできます。

2.  **プロジェクト**：プロジェクトは、同時に比較できる一連の実験です。各プロジェクトには専用のダッシュボードページがあり、さまざまな実行グループを簡単にオンまたはオフにして、さまざまなモデルバージョンを比較できます。

3.  **メモ**：自分へのクイックコミットメッセージ。メモはスクリプトから設定でき、テーブルで編集できます。

4.  **タグ**：ベースライン実行とお気に入り実行を特定します。タグを使用して実行をフィルタリングでき、テーブルで編集可能です。

```python
import wandb

config = dict (
  learning_rate = 0.01,
  momentum = 0.2,
  architecture = "CNN",
  dataset_id = "peds-0192",
  infra = "AWS",
)

wandb.init(
  project="detect-pedestrians",
  notes="tweak baseline",
  tags=["baseline", "paper1"],
  config=config,
)
```

##  **どのようなデータがログに記録されますか？**

スクリプトからログに記録されたすべてのデータは、ローカルの**wandb**ディレクトリにあるマシンに保存されてから、W＆Bクラウドまたはプライベートサーバーに同期されます。

### **自動的に記録**

*  **システムメトリック**：CPUおよびGPUの使用率、ネットワークなど。これらはnvidia-smiから取得され、実行ページの\[システム\]タブに表示されます。
* **コマンドライン**：stdoutとstderrが取得され、実行ページの\[ログ\]タブに表示されます。

  設定ページでコード保存をオンにして、以下を取得します。

* **Git commit**：最新のgit commitを取得し、実行ページの\[概要\]タブで確認します。コミットされていない変更点がある場合は、diff.patchファイルを確認します。
*  **ファイル**：requirements.txtファイルと、実行のために**wandb**ディレクトリに保存したファイルがアップロードされ、実行ページの\[ファイル\]タブに表示されます。

###  **特定の通話で記録**

データとモデルのメトリックが関係する場合、ログに記録する内容を正確に決定できます。

*    **データセット**：W＆Bにストリーミングするには、画像またはその他のデータセットサンプルを具体的にログに記録する必要があります。
*  **PyTorchグラデーション**：wandb.watch（model）を追加して、重みのグラデーションをUIのヒストグラムとして表示します。
* **構成・設定**：ログハイパーパラメータ、データセットへのリンク、または構成パラメータとして使用しているアーキテクチャーの名前を、wandb.init（config = your\_config\_dictionary）のように渡します。
* **メトリック**：wandb.log（）を使用して、モデルのメトリックを確認します。トレーニングループ内から精度やロスなどの指標をログに記録すると、UIにライブ更新グラフが表示されます

