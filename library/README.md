---
description: 実験の記録や追跡、データセットのバージョン管理、モデル管理のためのWeights＆Biases
---

# Library

 `wandb` Pythonライブラリを使用すると、数行のコードで機械学習実験を追跡できます。[PyTorch](https://docs.wandb.ai/v/japanese/integrations/pytorch)や[Keras](https://docs.wandb.ai/v/japanese/integrations/keras)などの一般的なフレームワークを使用している場合は、軽量[統合](https://app.gitbook.com/@weights-and-biases/s/docs/~/drafts/-MNTRmPsdM-fSSOyCL8w/v/japanese/integrations)を行います。

## **スクリプトにW&Bを統合する**

以下は、W＆Bで実験を記録・追跡するための簡単な構成要素です。また、[PyTorch](file:////integrations/pytorch)、 [Keras](file:////integrations/keras)、[Scikit](file:////integrations/scikit)などの特別な統合も多数あります。**統合**をご参照ください。

1. \*\*\*\*[**wandb.init\(\)**](init.md):  スクリプトの先頭で新しい実行を初期化します。これにより、Runオブジェクトが返され、すべてのログとファイルが保存されるローカルディレクトリが作成されます。そしてW＆Bサーバーに非同期でストリーミングされます。ホスト型クラウドサーバーの代わりにプライベートサーバーを使用したい場合は、[セルフホスティングを提供しています](https://app.gitbook.com/@weights-and-biases/s/docs/~/drafts/-MNTRmPsdM-fSSOyCL8w/v/japanese/self-hosted)。
2. \*\*\*\*[**wandb.config**](config.md): 学習率やモデルタイプなどのハイパーパラメータの辞書を保存します。configでキャプチャしたモデル設定により、後で結果を整理したり問い合わせたりすることができます。
3. \*\*\*\*[**wandb.log\(\)**](log.md): 精度や損失など、トレーニングループ内の時間経過に伴うメトリックをログに記録します。デフォルトでは、wandb.log（）を呼び出すと、履歴オブジェクトに新しいステップが追加され、サマリーオブジェクトが更新されます。

   o **履歴**：時間の経過とともにメトリックを追跡する辞書のようなオブジェクトの配列。これらの時系列値は、UIにデフォルトのラインプロットとして表示されます。

   o   **サマリー**：デフォルトで、wandb.log（）でログに記録されるメトリックの最終値。メトリックの要約をマニュアル設定して、最終値の代わりに最高精度または最小損失を取得できます。これらの値は、実行を比較するテーブルとプロットで使用されます。たとえば、プロジェクト内のすべての実行の最終精度で視覚化できます。

4. \*\*\*\*[**Artifacts**](../artifacts/): モデルの重みや予測テーブルなど、実行の出力をアーティファクトに保存します。これによって、モデルトレーニングだけでなく、最終モデルに影響を与えるすべてのパイプライン部分を追跡できます。

##  **ベストプラクティス**

`wandb`ライブラリは非常に柔軟です。いくつかの推奨ガイドラインを以下に提示します。

1.   **コンフィギュレーション**：ハイパーパラメータ、アーキテクチャ、データセットや、モデルの再現に使用するあらゆるものを追跡します。これらは列に表示されます。コンフィギュレーション列を使用して、実行をアプリで動的にグループ化、並べ替え、フィルタリングできます。

2. **プロジェクト**：プロジェクトは、同時に比較できる一連の実験です。各プロジェクトには専用のダッシュボードページがあり、さまざまな実行グループを簡単にオン・オフにして、さまざまなモデルバージョンを比較できます。

3.  **メモ**：自分自身へのクイックコミットメッセージ。メモはスクリプトで設定し、テーブルで編集します。

4.  **タグ**：ベースライン実行とお気に入り実行を特定します。タグを使用して実行をフィルタリングし、テーブルで編集します。

```python
import wandb

config = dict (
  learning_rate = 0.01,
  momentum = 0.2,
  architecture = "CNN",
  dataset_id = "peds-0192",
  infra = "AWS",
)

wandb.init(
  project="detect-pedestrians",
  notes="tweak baseline",
  tags=["baseline", "paper1"],
  config=config,
)
```

##  **どのようなデータがログに記録されますか？**

スクリプトからログに記録されたすべてのデータは、ローカルの**wandb**ディレクトリにあるマシンに保存されてから、W＆Bクラウドまたは[プライベートサーバー](https://docs.wandb.ai/self-hosted)に同期されます。

### **自動的に記録**

* **システムメトリック**：CPUおよびGPUの使用率、ネットワークなど。これらは[nvidia-smi](https://developer.nvidia.com/nvidia-system-management-interface)から取得され、実行ページの\[システム\]タブに表示されます。
* **コマンドライン**：stdoutとstderrが取得され、実行ページの\[ログ\]タブに表示されます。

アカウントの[設定](https://wandb.ai/settings)ページで[コード保存](http://wandb.me/code-save-colab)をオンにして、以下を取得します。

* **Git commit**：最新のgit commitを取得し、実行ページの\[概要\]タブで確認します。コミットされていない変更点がある場合は、diff.patchファイルを確認します。
* **ファイル**：requirements.txtファイルが、実行のために**wandb**ディレクトリに保存されるあらゆるファイルとともにアップロードされ、実行ページの\[ファイル\]タブに表示されます。

###  **特定のコールで記録**

データとモデルのメトリックが関係する場合、ログに記録する内容を正確に決定できます。

*    **データセット**：W＆Bにストリーミングするには、画像またはその他のデータセットサンプルを具体的にログに記録する必要があります。
* **PyTorchグラデーション**：wandb.watch（model）を追加して、重みのグラデーションをUIにヒストグラムとして表示します。
* **コンフィグ**：ログハイパーパラメータ、データセットへのリンク、または構成パラメータとして使用しているアーキテクチャ名を、wandb.init（config = your\_config\_dictionary）のように渡します。
* **メトリック**：`wandb.log（）`を使用して、モデルのメトリックを確認します。トレーニングループ内から精度やロスなどのメトリックをログに記録すると、UIにライブ更新グラフが表示されます

